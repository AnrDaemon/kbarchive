---
layout: page
title: "Q169426: BUG: Temp SP Generated by SQLPrepare Is Not Dropped"
permalink: /kb/169/Q169426/
---

## Q169426: BUG: Temp SP Generated by SQLPrepare Is Not Dropped

	Article: Q169426
	Product(s): Open Database Connectivity (ODBC)
	Version(s): WINDOWS:2.65
	Operating System(s): 
	Keyword(s): kbprogramming
	Last Modified: 04-JAN-2000
	
	-------------------------------------------------------------------------------
	The information in this article applies to:
	
	- Microsoft ODBC Driver for SQL Server, version 2.65 
	-------------------------------------------------------------------------------
	
	BUG #: 16643 (SQL)
	
	SYMPTOMS
	========
	
	If the SQLSetStmtOption parameter SQL_USE_PROCEDURE_FOR_PREPARE is set to the
	value SQL_UP_ON_DROP, the temporary stored procedure generated should be dropped
	upon the SQLFreeStmt call with SQL_DROP. However, the temporary stored procedure
	generated by SQLPrepare is not dropped until SQLDisconnect if SQLServer execute
	syntax is used. This may cause the tempdb to fill up.
	
	
	WORKAROUND
	==========
	
	To work around this problem, use the ODBC syntax (for example, {call sp1}).
	
	STATUS
	======
	
	Microsoft has confirmed this to be a problem in the Microsoft SQL Server ODBC
	driver version 2.65. We are researching this problem and will post new
	information here in the Microsoft Knowledge Base as it becomes available.
	
	Additional query words: 2.65.0240
	
	======================================================================
	Keywords          : kbprogramming 
	Technology        : kbSQLServSearch kbAudDeveloper kbODBCSearch kbODBCSQLServ265
	Version           : WINDOWS:2.65
	Issue type        : kbbug
	
	=============================================================================
	
