---
layout: page
title: "Q135926: SMTP: SMTPPUT 201: Failure Submitting Message to Mail Database"
permalink: /kb/135/Q135926/
---

## Q135926: SMTP: SMTPPUT 201: Failure Submitting Message to Mail Database

{% raw %}

	Article: Q135926
	Product(s): Microsoft Mail For PC Networks
	Version(s): MS-DOS:3.0
	Operating System(s): 
	Keyword(s): 
	Last Modified: 26-FEB-2000
	
	-------------------------------------------------------------------------------
	The information in this article applies to:
	
	- Microsoft Mail Gateway to SMTP, version 3.0 
	-------------------------------------------------------------------------------
	
	SYMPTOMS
	========
	
	The File Format Application Programming Interface (FFAPI) access component
	Smtpput.exe that is provided for the SMTP gateway will return the following 201
	error code when the program is unable to successfully deliver a message to a
	postoffice:
	
	  SMTPPUT returned 201
	  201 - 1 - 140 - Failure submitting message to mail database
	
	  [tx] 552 Error in local delivery
	
	CAUSE
	=====
	
	The 201 error code is generated by the FFAPI access component Smtpput.exe. The
	error is returned to the gateway when Smtpput.exe is unable to insert the
	message into the postoffice database.
	
	The 201 error code is caused by the following conditions:
	
	- Network file contention.
	
	- Insufficient disk space.
	
	- Postoffice directory structure incomplete or corrupt.
	
	- Insufficient access rights granted to gateway machine.
	
	- Insufficient file handles.
	
	- Network problems accessing the postoffice files.
	
	- Alias address in SMTP gateway larger than 10 characters for version 3.0.8.
	
	- Corrupt or incorrect format of the Microsoft Mail File Format(MMFF) file.
	
	RESOLUTION
	==========
	
	Network File Contention
	-----------------------
	
	SMTPPUT.EXE component must access certain files to create a message on a
	postoffice. Gateways that service postoffices that receive high volumes of
	message transfers and are serviced by the External Mail program should consider
	disabling mailer (-md).
	
	The files accessed by Smtpput.exe with mailer disabled are Access.glb,
	Access2.glb, Master.glb, C850sort.glb, Group.glb, Network.glb, Control.glb,
	Inqueue3.key, and Inqueue3.mbg. These files may be locked by other processes
	temporarily while in use.
	
	NOTE: The 201 error has been reproduced by locking the Inqueue3.mbg file.
	
	Postoffices located on Novell servers that operate under high-traffic conditions
	are recommended to set the postoffice as shareable with a few exceptions. There
	are certain conditions that dictate that the Control.glb, Tid.glb, Flag.glb, and
	Master.glb should only be accessed by one process at a time; thus, they should
	not be shareable.
	
	For additional information, please see the Microsoft Mail Gateway to SMTP
	"Administrator's Guide" and/or the following article in the Microsoft Knowledge
	Base:
	
	  Q99204 Doc Err: Setting Attributes for High Traffic Network
	
	The most common problem is the Inqueue3.mbg is being locked by another external
	or gateway. This problem can be compounded if the other external or gateway is
	operating on a slow machine or over a slow link. The option -v20 or CompatV20
	utilized by the External Mail program will add additional file locking
	functionality, increasing the amount of network overhead and possibly causing
	additional network file contention. Additional network file contention can be
	created by improperly running the External Mail program from a network drive
	(see page 233 of the "Administrator's Guide").
	
	Insufficient Disk Space
	-----------------------
	
	Insufficient disk space will prevent the client from enlarging or creating
	postoffice files. Novell NetWare file servers can produce a insufficient disk
	space response to the program when the files have become ownerless or the purge
	file has used all the available disk space.
	
	Postoffice Directory Structure
	------------------------------
	
	The postoffice directory structure consists of 19 main subdirectories.
	
	For additional information, please see the following article in the Microsoft
	Knowledge Base:
	
	  Q77926 Description of Mail Database Subdirectories
	
	Insufficient Access Rights
	--------------------------
	
	The gateway components should be given full network access rights for the
	postoffice.
	
	For additional information, please see the Microsoft Mail Gateway to SMTP
	"Administrator's Guide" and/or the following articles in the Microsoft Knowledge
	Base:
	
	  Q103380 File Scan Rights Required for Novell NetWare
	
	  Q117152 MTA Not Report LAN Man User-Level Security Problems
	
	  Q121798 Err Msg: You Do Not Have the Proper Access...
	
	Insufficient File Handles
	-------------------------
	
	Increase the number of file handles to 50 in the Config.sys file of the
	workstation running the gateway.
	
	Network Problems
	----------------
	
	The Smtpput.exe utilizes the network components to effectively perform the file
	commands that create and manipulate each file. Network problems that interfere
	with the operation of these commands can cause the 201 error to occur.
	
	SMTP Alias Address Larger Than 10 Characters
	--------------------------------------------
	
	The SMTP gateway version 3.0.9 resolves an issue that can cause a 201 error to be
	logged. The Readme.txt file included with version 3.0.9 of the SMTP gateway
	discusses the problem when an alias name is larger than 10 character.
	
	MMFF file problems
	------------------
	
	Ensure that the MMFF file TO_NC.API submitted by the gateway follows either the
	Basic or Extended Message Format for the Smtpput.exe program to properly convert
	(definition begins on page 50 in the FFAPI SDK).
	
	MORE INFORMATION
	================
	
	The error displayed may consist of three numbers separated by a hyphen (-); for
	example,
	
	  (201 - 1 - 140).
	
	The error code number 201 signifies that the error occurred when you tried to
	insert the message into the database. The second number, 1, can signify the
	number of messages sent per socket connection. It will rarely exceed 2. The last
	number refers to the line number of the message indicated by the second number.
	It is only valid if the problem was created by a corrupted or incorrectly
	formatted MMFF file.
	
	Additional query words: 3.00
	
	======================================================================
	Keywords          :  
	Technology        : kbMailSearch kbMailGateSearch kbZNotKeyword3 kbMailGateSMTP300
	Version           : MS-DOS:3.0
	Issue type        : kbprb
	
	=============================================================================
	

{% endraw %}
