---
layout: page
title: "Q188636: XADM: Error Generating OAB from Large Containers"
permalink: kb/188/Q188636/
---

## Q188636: XADM: Error Generating OAB from Large Containers

	Article: Q188636
	Product(s): Microsoft Exchange
	Version(s): WINDOWS:4.0,5.0,5.5
	Operating System(s): 
	Keyword(s): 
	Last Modified: 21-APR-1999
	
	-------------------------------------------------------------------------------
	The information in this article applies to:
	
	- Microsoft Exchange Server, versions 4.0, 5.0, 5.5 
	-------------------------------------------------------------------------------
	
	SYMPTOMS
	========
	
	When attempting to generate the Offline Address Book (OAB) using the Global
	Address List or certain large containers, the following error message is
	generated:
	
	  An error occurred while generating the offline Address Book. To
	  view details, see the application event log in the Windows NT
	  Event Viewer on the offline Address Book server.
	
	  Microsoft Exchange Administrator
	  ID no. c1031662
	
	The Event Viewer will log the following event:
	
	  Event ID 5004
	  Generation of the offline Address Book is complete. Result: An
	  error occurred.
	
	CAUSE
	=====
	
	The above error is generated when the mailboxes or custom recipients in the
	containers have unique SMTP domains in their SMTP addresses.
	
	For example, consider a recipient container called "Foreign Recipients" that
	contains custom recipients. Each of the custom recipients has an SMTP address
	that has the following format:
	
	  Invalid_Name@<Alias>.Unused
	
	Where <Alias> is the Alias of the custom recipient.
	
	The above SMTP addresses may be generated by importing the custom recipients with
	predefined SMTP addresses instead of allowing the Exchange Server proxy
	generator to generate the SMTP address.
	
	The idea behind generating SMTP addresses with the above format may be to prevent
	external users from being able to mail to the custom recipients.
	
	When the Offline Address Book is being generated, if the number of SMTP domains
	in the SMTP addresses being added to the OAB is very large, the above error
	message is generated.
	
	WORKAROUND
	==========
	
	Change the SMTP addresses so that each recipient does not have a unique SMTP
	domain name. Normally, all recipients should have the same domain name in their
	SMTP addresses.
	
	This can be done by exporting out the directory information for the affected
	recipients to a .csv file, using the Exchange Server Administrator program. On
	the Tools menu, click Directory Export. Then modify the SMTP address in the
	E-Mail Addresses column of the .csv file. Import the modified file back into the
	Exchange directory store.
	
	======================================================================
	Keywords          :  
	Technology        : kbExchangeSearch kbExchange500 kbExchange550 kbExchange400 kbZNotKeyword2
	Version           : WINDOWS:4.0,5.0,5.5
	Issue type        : kbprb
	
	=============================================================================
	
