---
layout: page
title: "Q140681: Incomplete SQL Server Upgrade Causes Problems Creating Jobs"
permalink: /kb/140/Q140681/
---

## Q140681: Incomplete SQL Server Upgrade Causes Problems Creating Jobs

{% raw %}

	Article: Q140681
	Product(s): Microsoft Windows NT
	Version(s): 1.10
	Operating System(s): 
	Keyword(s): kbsetup smssetupkbfixlist
	Last Modified: 27-JUL-2001
	
	-------------------------------------------------------------------------------
	The information in this article applies to:
	
	- Microsoft Systems Management Server version 1.1 
	-------------------------------------------------------------------------------
	
	
	SYMPTOMS
	========
	
	After you upgrade from Microsoft SQL Server version 4.21a to SQL Server 6.0 for
	Systems Management Server, the sending of jobs fails. One or more of the
	following error messages from SCHED.LOG located in
	<drive>:\<sms>\LOGS appear and indicate the problem:
	
	  General SQL Server error: Check messages from the SQL Server.
	  You must drop and recreate procedure sp_GetSubSite.
	
	-or-
	
	  You must drop and recreate procedure sp_GetSubGroupSites
	
	If you check the UPGRADE.OUT file which is generated by SQL Setup during the
	upgrade process the one or more of the following messages can be found:
	
	  Msg 208, Level 16, State 1
	  Invalid object name "#Sites".
	  Error occurred updgrading object sp_GetSubSites in database SMS, please drop
	  and recreate.
	
	  -or-
	
	  Msg 208, Level 16, State 1
	  Invalid object name "#Sites".
	  Error occurred updgrading object sp_GetSubGroupSites in database SMS, please
	  drop and recreate.
	
	CAUSE
	=====
	
	During the upgrade the stored procedures sp_GetSubSite and sp_GetSubGroupSites
	could not be updated.
	
	
	RESOLUTION
	==========
	
	To fix the problem run an SQL script, which is stored in a file called
	SP_SITE.SQL in the <drive>:\<sms>\SITE.SRV\<Platform>.bin
	directory. Use the Query Analyzer in the SQL 6.0 Enterprise Manager or ISQL/w to
	execute the script file against the Systems Management Server database.
	
	STATUS
	======
	
	Microsoft has confirmed this to be a problem in Systems Management Server
	version 1.1. This problem has been corrected in Systems Management Server
	version 1.2.
	
	Additional query words: prodsms 1.00
	
	======================================================================
	Keywords          : kbsetup smssetup kbfixlist
	Technology        : kbSMSSearch kbSMS110
	Version           : 1.10
	
	=============================================================================
	

{% endraw %}
