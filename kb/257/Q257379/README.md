---
layout: page
title: "Q257379: Wspsrv.exe Exception: Access Violation (0xC0000005)"
permalink: /kb/257/Q257379/
---

## Q257379: Wspsrv.exe Exception: Access Violation (0xC0000005)

	Article: Q257379
	Product(s): Microsoft Windows NT
	Version(s): 2.0,4.0,4.x,5.0,5.5
	Operating System(s): 
	Keyword(s): kberrmsg kbWinNT400PreSP7Fix
	Last Modified: 08-MAY-2002
	
	-------------------------------------------------------------------------------
	The information in this article applies to:
	
	- Microsoft Windows NT Server version 4.0 
	- Microsoft Proxy Server version 2.0 
	-------------------------------------------------------------------------------
	
	SYMPTOMS
	========
	
	The Proxy Server 2.0 Winsock Proxy service may stop and may generate a
	Drwtsn32.log file. The error message is:
	
	  WSPSRV.EXE Exception: access violation (0xC0000005)
	
	The module causing the access violation is Rnr20.dll.
	
	CAUSE
	=====
	
	This problem can occur if you use Proxy Server 2.0 to server proxy for Exchange
	Server. Reverse Domain Name Service (DNS) lookups generated by domain filters on
	either the proxy server or the Exchange SMTP service may trigger the access
	violation.
	
	The access violation is actually being caused by single-threaded programs
	generating an excessive number of GetXbyYData calls.
	
	RESOLUTION
	==========
	
	A supported fix is now available from Microsoft, but it is only intended to
	correct the problem that is described in this article. Apply it only to
	computers that are experiencing this specific problem. This fix may receive
	additional testing. Therefore, if you are not severely affected by this problem,
	Microsoft recommends that you wait for the next Windows NT 4.0 service pack that
	contains this fix.
	
	To resolve this problem immediately, contact Microsoft Product Support Services
	to obtain the fix. For a complete list of Microsoft Product Support Services
	phone numbers and information about support costs, visit the following Microsoft
	Web site:
	
	  http://support.microsoft.com/default.aspx?scid=fh;EN-US;CNTACTMS
	
	NOTE: In special cases, charges that are ordinarily incurred for support calls
	may be canceled if a Microsoft Support Professional determines that a specific
	update will resolve your problem. The typical support costs will apply to
	additional support questions and issues that do not qualify for the specific
	update in question.
	
	The English-language version of this fix should have the following file
	attributes or later:
	
	  Date        Time      Size      File name   
	  -------------------------------------------
	  05/01/00    06:48p    77,584    Mswsock.dll
	  05/01/00    06:48p    45,840    Rnr20.dll
	  05/01/00    06:48p    20,752    Wsock32.dll
	
	
	
	To prevent this problem from occurring, disable anything that may create a large
	number of reverse DNS lookups.
	
	In Proxy Server 2.0, disable domain filters.
	
	In Exchange Server, disable SMTP reverse DNS lookups. For additional information
	about how to do this, click the article number below to view the article in the
	Microsoft Knowledge Base:
	
	  Q190026 XFOR: SMTP Protocol Log Only Shows Connection Established Else
	
	STATUS
	======
	
	Microsoft has confirmed that this is a problem in Windows NT 4.0.
	
	MORE INFORMATION
	================
	
	This problem does not occur in Microsoft Windows 2000.
	
	
	Additional query words:
	
	======================================================================
	Keywords          : kberrmsg kbWinNT400PreSP7Fix 
	Technology        : kbWinNTsearch kbWinNT400search kbWinNTSsearch kbWinNTS400search kbWinNTS400 kbAudDeveloper kbProxyServSearch kbProxyServ200
	Version           : :2.0,4.0,4.x,5.0,5.5
	Hardware          : ALPHA x86
	Issue type        : kbbug
	Solution Type     : kbfix
	
	=============================================================================
	
