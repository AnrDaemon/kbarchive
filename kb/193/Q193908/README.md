---
layout: page
title: "Q193908: SNA Server Application Exception When Using SET_TP_PROPERTIES"
permalink: /kb/193/Q193908/
---

## Q193908: SNA Server Application Exception When Using SET_TP_PROPERTIES

	Article: Q193908
	Product(s): Microsoft SNA Server
	Version(s): WINDOWS:3.0,3.0 SP1,3.0 SP2,3.0 SP3,4.0,4.0 SP1
	Operating System(s): 
	Keyword(s): kbbuglist
	Last Modified: 25-SEP-1999
	
	-------------------------------------------------------------------------------
	The information in this article applies to:
	
	- Microsoft SNA Server, versions 3.0, 3.0 SP1, 3.0 SP2, 3.0 SP3, 4.0, 4.0 SP1 
	-------------------------------------------------------------------------------
	
	SYMPTOMS
	========
	
	An Advanced Program-to-Program Communication (APPC) application that uses SNA
	Server's Sync Point feature can use the SET_TP_PROPERTIES verb to set its
	Logical Unit of Work Identifier (LUWIDs) by specifying an existing value or by
	requesting the SNA Server to generate new ones. The SNA Server SDK documentation
	for the SET_TP_PROPERTIES verb indicates the following for its opext parameter:
	
	  opext
	  Supplied parameter. Specifies the verb operation extension. The AP_EXTD_VCB
	  bit must be set to indicate that the set_tp_properties structure requires
	  Sync Point support.
	
	If the AP_EXTD_VCB bit is in the opext parameter of the SET_TP_PROPERTIES verb, a
	primary return code of 0xFFFF will be returned when the application runs this
	portion of code. This error indicates an invalid opcode.
	
	If the AP_EXTD_VCB is not set in the opext parameter, the SNA Server service will
	generate an application exception when the application is started.
	
	The application exception will generate a Drwtsn32.log if Drwtsn32.exe is
	configured as the default debugger on the SNA Server system. In addition, an
	Event 624 may be logged in the Windows NT Application Event Log indicating that
	a Snadump.log file was generated.
	
	CAUSE
	=====
	
	The application exception in the SNA Server service only occurs when the
	SET_TP_PROPERTIES verb requests that a new LUWID be generated by the SNA Server.
	When generating the new LUWID, the SNA Server tries to use a resource control
	block that does not exist, which results in the application exception.
	
	
	In addition, the SNA Server SDK incorrectly indicates that the AP_EXTD_VCB bit
	must be set for the opext parameter of the SET_TP_PROPERTIES verb.
	
	RESOLUTION
	==========
	
	Microsoft has confirmed this to be a problem in SNA Server versions 3.0, 3.0
	SP1, 3.0 SP2, 3.0 SP3, 4.0, and 4.0 SP1. We are researching this problem in SNA
	Server version 3.0 and will post more information here in the Knowledge Base as
	it becomes available.
	
	This problem was corrected in the latest SNA Server version 4.0 U.S. Service
	Pack. For information on obtaining this Service Pack, query on the following
	word in the Microsoft Knowledge Base (without the spaces):
	
	  S E R V P A C K
	
	
	Additional query words:
	
	======================================================================
	Keywords          :  kbbuglist
	Technology        : kbAudDeveloper kbSNAServSearch kbSNAServ300 kbSNAServ400 kbSNAServ300SP3 kbSNAServ300SP1 kbSNAServ400SP1 kbSNAServ300SP2
	Version           : WINDOWS:3.0,3.0 SP1,3.0 SP2,3.0 SP3,4.0,4.0 SP1
	Issue type        : kbbug
	Solution Type     : kbfix
	
	=============================================================================
	
