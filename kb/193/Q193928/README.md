---
layout: page
title: "Q193928: XCON:Internet Mail Service Won't Start - Event ID 4007 &amp; 4020"
permalink: kb/193/Q193928/
---

## Q193928: XCON:Internet Mail Service Won't Start - Event ID 4007 &amp; 4020

	Article: Q193928
	Product(s): Microsoft Exchange
	Version(s): winnt:5.0,5.5
	Operating System(s): 
	Keyword(s): 
	Last Modified: 06-AUG-2000
	
	-------------------------------------------------------------------------------
	The information in this article applies to:
	
	- Microsoft Exchange Server, versions 5.0, 5.5 
	-------------------------------------------------------------------------------
	
	SYMPTOMS
	========
	
	The Internet Mail Service does not start, and the following error messages are
	displayed:
	
	  Error 2140: An Internal Windows NT error
	
	  Event ID: 4007
	  Source: MSExchangeIMC
	  Description: The following error occurred while trying to bind the TCP/IP
	  listener socket (10050)
	
	  Event ID: 4020
	  Source: MSExchangeIMC
	  Description: Unable to start service because Winsock could not be initialized.
	
	WORKAROUND
	==========
	
	These error messages can be generated by one of the following scenarios, and
	corrected by the instructions provided with each scenario.
	
	Scenario A:
	
	After the Exchange Server computer has been configured as a proxy client, within
	the Mspclnt.ini file, there is a section called [Servers IP Address], with the
	following entry:
	
	  Name = <NetBIOS name>
	
	When this entry is changed to the IP Address of the proxy server, the Internet
	Mail Service will start.
	
	NOTE: The problem is that once the computer is restarted, the Mspclnt.ini entry
	reverts back to the NetBIOS name. To stop this from happening, a setting on the
	proxy server needs to be reconfigured to use the IP address instead of the
	NetBIOS name. Follow these steps:
	
	1. Open Internet Service Manager.
	
	2. Open the Properties for Web Proxy, Winsock Proxy, or Socks Proxy.
	
	  (NOTE: They are all linked).
	
	3. Select the Services tab.
	
	4. Select Client Configuration.
	
	5. Select the IP Address option.
	
	6. Click OK.
	
	7. Click OK.
	
	8. Stop all three proxies (mentioned in step 2), restart them, and then Goto
	  client.
	
	9. In the WSP client in Control Panel, click Update.
	
	Scenario B:
	
	If you are connecting through any firewall besides Microsoft Proxy Server, make
	sure that the Microsoft Proxy client is disabled.
	
	Scenario C:
	
	Check on the Proxy 2 server for the existence of the SMTP Windows NT Option Pack
	service that comes with the Windows NT 4.0 Options Pack. If the service is
	installed, do the following:
	
	1. Click Start, point to Settings, click Control Panel, and then double-click
	  Services.
	
	2. Change the Microsoft SMTP service to manual.
	
	3. Stop the Windows NT Option Pack service.
	
	After the SMTP Windows NT Option Pack service has been stopped, the Internet Mail
	Service will run.
	
	Scenario D:
	
	Try to Ping the Proxy server by name. If you cannot, do the following:
	
	1. Map a drive to the Proxy server.
	
	2. Go to the Winnt\System32\Drivers\Etc directory, and edit the host file.
	
	3. Type the internal IP of the Proxy server, tab over once, type the server
	  name, and press ENTER. You should be able to ping the Proxy server at this
	  point.
	
	Additional query words:
	
	======================================================================
	Keywords          :  
	Technology        : kbExchangeSearch kbExchange500 kbExchange550 kbZNotKeyword2
	Version           : winnt:5.0,5.5
	Issue type        : kbprb
	
	=============================================================================
	
