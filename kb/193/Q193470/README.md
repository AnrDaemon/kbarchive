---
layout: page
title: "Q193470: FIX: Setup Error 827 Installing Multiple OCX Files"
permalink: /kb/193/Q193470/
---

## Q193470: FIX: Setup Error 827 Installing Multiple OCX Files

{% raw %}

	Article: Q193470
	Product(s): Microsoft FoxPro
	Version(s): WINDOWS:6.0
	Operating System(s): 
	Keyword(s): kberrmsg kbservicepack kbwizard kbActiveX kbAppSetup kbvfp600 kbvfp600bug kbVS600sp2 kb
	Last Modified: 20-MAY-1999
	
	-------------------------------------------------------------------------------
	The information in this article applies to:
	
	- Microsoft Visual FoxPro for Windows, version 6.0 
	-------------------------------------------------------------------------------
	
	SYMPTOMS
	========
	
	You create an application distribution with the Visual FoxPro Setup Wizard and
	the distribution contains multiple ActiveX controls (.ocxs) that you have added
	to the application distribution directory. When you attempt to install the
	application, you may see the following error occur:
	
	  Setup Error 827
	  Object <nn>
	  Your Setup files may be damaged. Try restarting the setup program
	  from where you originally ran it.
	
	CAUSE
	=====
	
	The setup script file, Setup.stf, generated by the Setup Wizard contains an
	error in the line that specifies the ActiveX control installation. Notice below
	that objects 33 and 36 get merged and become 3336. There needs to be a space
	between them. Here is the example:
	
	  10       Ole Custom Controls   Group   32 3336 37     vital      %M
	
	RESOLUTION
	==========
	
	As a workaround, you may use one of the two following techniques.
	
	Method One
	----------
	
	Add the controls to your distribution using the Add ActiveX Controls dialog box,
	rather than placing them in your distribution directory:
	
	1. Select the ActiveX controls... check box in step 2 of the Setup Wizard, which
	  then displays the Add ActiveX Controls dialog box.
	
	2. Find the controls you want to distribute in the list box within the dialog
	  box, and select the check boxes next to each one.
	
	This method is new in Visual FoxPro 6.0, and is preferred because it does not
	require that you place the .ocx files in your distribution directory, but
	automatically pulls them in for you.
	
	Method Two
	----------
	
	Edit the Setup.stf file created by the Setup Wizard and add a space between the
	merged numbers. Note that you have to repeat this for the Setup.stf file created
	for each disk image type you have selected in the Disk Images check boxes in the
	Setup Wizard step 3. You also have to repeat this if you subsequently re-run the
	Setup Wizard because this creates a new Setup.stf file or files:
	
	1. Double-click the file and select Notepad as the program to open the file
	  with.
	
	2. Look for a line similar to the following. The numbers may vary, but you
	  should see the text "Ole Custom Controls". Note that the number at the
	  beginning of the line, in this case 10, corresponds with the Object number in
	  the error dialog box:
	
	  10    Ole Custom Controls   Group   32 3336 37      vital       %M
	
	3. Add a space between the numbers to make the line read as follows:
	
	  10    Ole Custom Controls   Group   32 33 36 37      vital       %M
	
	4. Save the file and close Notepad.
	
	STATUS
	======
	
	Microsoft has confirmed this to be a bug in the Microsoft products listed at the
	beginning of this article.
	
	This bug has been fixed in the updated version of the Setup Wizard Vfp6swiz.exe
	dated 10/08/1998. This bug was corrected in Visual Studio 6.0 Service Pack 3.
	For more information about Visual Studio service packs, please see the following
	articles in the Microsoft Knowledge Base:
	
	Q194022 INFO: Visual Studio 6.0 Service Packs, What, Where, Why
	
	Q194295 HOWTO: Tell That Visual Studio 6.0 Service Packs Are Installed
	
	MORE INFORMATION
	================
	
	The Setup.stf file is a script that the Setup.exe file uses to determine which
	files get installed with your application. The location of this file depends on
	which Disk Images check box(es) you have selected in step 3 of the Setup
	Wizard:
	
	  Check box                   Location
	  ----------------------------------------------------------------------
	
	  1.44 MB 3.5 Inch            <Disk Images directory> + \Disk144\Disk1
	  Websetup (compressed)       <Disk Images directory> + \Websetup
	  Netsetup (uncompressed)     <Disk Images directory> + \Netsetup
	
	Steps to Reproduce Behavior
	---------------------------
	
	1. Create a source directory with an executable file. The executable can be a
	  Visual FoxPro .exe file, or any other executable like Notepad.exe, for
	  example.
	
	2. Copy two or more .ocx files to that directory. The .ocx files are located in
	  the Windows\System directory in Windows 9x or the WINNT\System32 directory in
	  Windows NT. You can use the Msacal70.ocx and Richtx32.ocx files, for example.
	
	3. Run the Setup Wizard.
	
	4. In the Setup Wizard step 1, select the directory you created in Step 1, and
	  then click the Next button twice.
	
	5. In step 3, type in a Disk Images directory name, and then click the Next
	  button.
	
	6. In step 4, type "Test" in the Setup dialog box caption text box and "None" in
	  the Copyright information text box. Click the Finish button twice. Click the
	  Done button in the Setup Wizard Disk Statistics dialog box to complete the
	  Setup Wizard.
	
	7. Run the Setup.exe file in the Disk144\Disk1, Netsetup, or Websetup directory
	  (this depends on what check boxes you selected in the Setup Wizard step 3).
	  If you accepted the default of 1.44 MB disks, then this will be the
	  Disk144\Disk1 directory.)
	
	8. Click the Continue button in the first setup dialog box, and then click the
	  OK button in the next three setup dialog boxes, and note that an error
	  similar to the one described in the SYMPTOMS section is displayed.
	
	REFERENCES
	==========
	
	For more information on the updated Setup Wizard, please see the following URL:
	
	http://msdn.microsoft.com/vfoxpro/downloads/updates.asp
	
	(c) Microsoft Corporation 1999, All Rights Reserved.
	Contributions by Jim Saunders, Microsoft Corporation
	
	
	Additional query words:
	
	======================================================================
	Keywords          : kberrmsg kbservicepack kbwizard kbActiveX kbAppSetup kbvfp600 kbvfp600bug kbVS600sp2 kbVS600SP1 kbVS600sp3fix 
	Technology        : kbVFPsearch kbAudDeveloper kbVFP600
	Version           : WINDOWS:6.0
	Issue type        : kbbug
	Solution Type     : kbfix
	
	=============================================================================
	

{% endraw %}
