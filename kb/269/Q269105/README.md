---
layout: page
title: "Q269105: SMS Provider May Not Recognize DMTF Dates"
permalink: /kb/269/Q269105/
---

## Q269105: SMS Provider May Not Recognize DMTF Dates

	Article: Q269105
	Product(s): Microsoft Systems Management Server
	Version(s): 2.0 SP2
	Operating System(s): 
	Keyword(s): kbsms200 kbsms120 kbsms120bug
	Last Modified: 06-FEB-2001
	
	-------------------------------------------------------------------------------
	The information in this article applies to:
	
	- Microsoft Systems Management Server version 2.0 SP2 
	-------------------------------------------------------------------------------
	
	SYMPTOMS
	========
	
	The SMS provider does not recognize Distributed Management Task Force (DMTF)
	dates that are generated by the Windows Management Instrumentation (WMI) Open
	Database Connectivity (ODBC) adapter.
	
	CAUSE
	=====
	
	All dates and times in WMI use the format designed by the DMTF. When the WMI
	ODBC driver is presented with a SQL query that uses a DATETIME field in the
	"where" clause, such as
	
	  SELECT SMS_R_System.Name FROM "root\SMS\site_102".SMS_R_System SMS_R_System
	  WHERE (SMS_R_System.AgentTime>{ts '2000-06-01 00:00:00.000000'})
	
	it converts the query to WMI Query Language (WQL) format with the DATETIME field
	in DMTF format:
	
	  SELECT Name FROM SMS_R_System
	  WHERE AgentTime > 2000601000000.000000+000"
	
	This WQL query does not work in the SMS provider for two reasons:
	
	- Literal values compared against SMS_R_System.AgentTime are not treated as
	  time values.
	
	- The provider does not recognize the "+000" time format; it recognized only
	  the "+***" format.
	
	RESOLUTION
	==========
	
	To resolve this problem, obtain the latest service pack for Systems Management
	Server version 2.0. For additional information, please see the following article
	in the Microsoft Knowledge Base:
	
	  Q288239 SMS: How to Obtain the Latest Systems Management Server 2.0 Service
	  Pack
	
	
	
	STATUS
	======
	
	Microsoft has confirmed this to be a problem in the Microsoft products that are
	listed at the beginning of this article. This problem was first corrected in
	Systems Management Server 2.0 Service Pack 3.
	
	
	Additional query words: prodsms
	
	======================================================================
	Keywords          : kbsms200 kbsms120 kbsms120bug 
	Technology        : kbSMSSearch kbSMS200SP2
	Version           : :2.0 SP2
	Issue type        : kbbug
	Solution Type     : kbfix
	
	=============================================================================
	
