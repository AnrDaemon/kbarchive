---
layout: page
title: "Q240783: SMS Installer Does Not Repackage Large MULTI-SZ Registry Values"
permalink: /kb/240/Q240783/
---

## Q240783: SMS Installer Does Not Repackage Large MULTI-SZ Registry Values

{% raw %}

	Article: Q240783
	Product(s): Microsoft Systems Management Server
	Version(s): WINDOWS:2.0
	Operating System(s): 
	Keyword(s): kbsms200bug kbsms200fix kbsms200sp2fix
	Last Modified: 25-JUN-2000
	
	-------------------------------------------------------------------------------
	The information in this article applies to:
	
	- Microsoft Systems Management Server Installer version 2.0 
	-------------------------------------------------------------------------------
	
	SYMPTOMS
	========
	
	When you repackage a Setup program that creates or modifies a large (larger than
	64 KB) MULTI-SZ registry value with SMS Installer versions earlier than
	2.0.91.1, SMS Installer may be unable to open the resulting script, may be
	unable to compile the script, may improperly create the specified MULTI-SZ
	registry value, or may stop responding (hang) upon opening the script.
	
	Additionally, repackaging such a program with earlier (version 1.x.xx) versions
	of SMS Installer may work without error messages. This occurs because SMS
	Installer 1.xx.xx does not repackage changes to MULTI-SZ registry values.
	
	CAUSE
	=====
	
	The buffer that SMS Installer uses to hold registry values is not large enough
	to contain the MULTI-SZ registry value.
	
	Note that various programs that include McAfee VirusScan make use of large
	MULTI-SZ registry values. One registry value in particular that can contain a
	large amount of data and is frequently modified during program installation is:
	
	  SOFTWARE\Microsoft\Windows NT\CurrentVersion\Perflib\009
	
	RESOLUTION
	==========
	
	To resolve this problem, obtain the latest service pack for Systems Management
	Server version 2.0. For additional information, please see the following article
	in the Microsoft Knowledge Base:
	
	  Q236325 How to Obtain the Latest Systems Management Server 2.0 Service Pack
	
	
	
	WORKAROUND
	==========
	
	To work around this problem if MULTI-SZ registry values can be ignored, use an
	earlier version of SMS Installer.
	
	STATUS
	======
	
	Microsoft has confirmed this to be a problem in Systems Management Server
	version 2.0. This problem was first corrected in Systems Management Server
	version 2.0 Service Pack 2.
	
	MORE INFORMATION
	================
	
	Note that even with the hotfix mentioned in this article, you may be unable to
	open an SMS Installer script generated by repackaging a large MULTI-SZ registry
	modification if the script is created with a previous version of SMS Installer.
	This occurs because the hotfix actually works during the repackage process to
	break up large keys into smaller fragments. As a result, it is necessary to
	repeat any problem repackage operations with the hotfixed SMS Installer.
	
	To install the hotfixed SMS Installer, run the appropriate .exe file based on
	your processor platform.
	
	The third-party products discussed in this article are manufactured by vendors
	independent of Microsoft; we make no warranty, implied or otherwise, regarding
	these products' performance or reliability.
	
	Additional query words: prodsms
	
	======================================================================
	Keywords          : kbsms200bug kbsms200fix kbsms200sp2fix 
	Technology        : kbSMSSearch kbSMSI200
	Version           : WINDOWS:2.0
	Issue type        : kbbug
	Solution Type     : kbfix
	
	=============================================================================
	

{% endraw %}
