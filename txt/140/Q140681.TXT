DOCUMENT:Q140681  27-JUL-2001  [winnt]
TITLE   :Incomplete SQL Server Upgrade Causes Problems Creating Jobs
PRODUCT :Microsoft Windows NT
PROD/VER:1.10
OPER/SYS:
KEYWORDS:kbsetup smssetupkbfixlist

======================================================================
-------------------------------------------------------------------------------
The information in this article applies to:

 - Microsoft Systems Management Server version 1.1 
-------------------------------------------------------------------------------


SYMPTOMS
========

After you upgrade from Microsoft SQL Server version 4.21a to SQL Server 6.0 for
Systems Management Server, the sending of jobs fails. One or more of the
following error messages from SCHED.LOG located in
<drive>:\<sms>\LOGS appear and indicate the problem:

   General SQL Server error: Check messages from the SQL Server.
   You must drop and recreate procedure sp_GetSubSite.

-or-

   You must drop and recreate procedure sp_GetSubGroupSites

If you check the UPGRADE.OUT file which is generated by SQL Setup during the
upgrade process the one or more of the following messages can be found:

   Msg 208, Level 16, State 1
   Invalid object name "#Sites".
   Error occurred updgrading object sp_GetSubSites in database SMS, please drop
   and recreate.

   -or-

   Msg 208, Level 16, State 1
   Invalid object name "#Sites".
   Error occurred updgrading object sp_GetSubGroupSites in database SMS, please
   drop and recreate.

CAUSE
=====

During the upgrade the stored procedures sp_GetSubSite and sp_GetSubGroupSites
could not be updated.


RESOLUTION
==========

To fix the problem run an SQL script, which is stored in a file called
SP_SITE.SQL in the <drive>:\<sms>\SITE.SRV\<Platform>.bin
directory. Use the Query Analyzer in the SQL 6.0 Enterprise Manager or ISQL/w to
execute the script file against the Systems Management Server database.

STATUS
======

Microsoft has confirmed this to be a problem in Systems Management Server
version 1.1. This problem has been corrected in Systems Management Server
version 1.2.

Additional query words: prodsms 1.00

======================================================================
Keywords          : kbsetup smssetup kbfixlist
Technology        : kbSMSSearch kbSMS110
Version           : 1.10

=============================================================================

THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.

Copyright Microsoft Corporation 2001.