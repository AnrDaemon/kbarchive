DOCUMENT:Q130422  24-JUL-2001  [sms]
TITLE   :Environment Space Limitations With SMS Inventory Scripts
PRODUCT :Microsoft Systems Management Server
PROD/VER:winnt:1.1,1.2
OPER/SYS:
KEYWORDS:kbnetwork kbConfig smshowto smsconfig

======================================================================
-------------------------------------------------------------------------------
The information in this article applies to:

 - Microsoft Systems Management Server versions 1.1, 1.2 
-------------------------------------------------------------------------------

SUMMARY
=======

The scripts to install Systems Management Server on a computer (SMSLS.BAT and
RUNSMS.BAT) depend on having a certain amount of environment space available.
Without creating environment variables it would be very difficult for Systems
Management Server to support the various operating systems which it does.

MORE INFORMATION
================

If the necessary space is not available when the script is started, the script
will attempt to create a new command shell with additional free space, and make
another attempt to execute the script file (there are safeguards against extra
recursion). This is accomplished by a command similar to:

      command /e:2048 /c %0\..\smsls.bat

This implementation works for all the operating systems that typically experience
this problem (MS-DOS, Windows 3.1, Windows for Workgroups, and Windows 95).

If the new command shell is needed, Out of Environment Space messages may be
generated by the operating system; these are not errors. If SMSLS.BAT is called
from within a logon script and this message occurs, it can be eliminated by
calling SMSLS.BAT with a command similar to:

      call command /e:2048 /c %0\..\smsls.bat

Additional query words: prodsms sms

======================================================================
Keywords          : kbnetwork kbConfig smshowto smsconfig 
Technology        : kbSMSSearch kbSMS110 kbSMS120
Version           : winnt:1.1,1.2

=============================================================================

THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.

Copyright Microsoft Corporation 2001.