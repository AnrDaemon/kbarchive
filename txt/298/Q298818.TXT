DOCUMENT:Q298818  09-JUL-2001  [sms]
TITLE   :SMS: Duplicate SNMP Traps Sent on Windows 2000
PRODUCT :Microsoft Systems Management Server
PROD/VER::2.0
OPER/SYS:
KEYWORDS:kbSNMP kbsms200 kbsms200bug

======================================================================
-------------------------------------------------------------------------------
The information in this article applies to:

 - Microsoft Systems Management Server version 2.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

After you enable the Systems Management Server (SMS) 2.0 Event to Trap
Translator Client Agent for a site that contains Microsoft Windows 2000-based
client computers that are running the Simple Network Management Protocol (SNMP)
service, traps that are generated by events which are configured for alerts may
be sent twice to defined management stations.

CAUSE
=====

The default Windows 2000 SNMP installation includes an Event to Trap Translation
Extension Agent, which is implemented in a .dll file that is named Evntagnt.dll.
The SMS 2.0 Event to Trap Translator Client Agent installs an additional
extension agent that provides duplicate functionality implemented in a .dll file
that is named Snmpelea.dll. Both of these DLLs monitor the Windows 2000 Event
log according to the rules that are defined in the following registry key:

   HKEY_LOCAL_MACHINE\Software\Microsoft\SNMP_EVENTS

When a configured event is written to the Event log, each extension agent
generates a trap for it.

WORKAROUND
==========

To work around this behavior, you can disable the SMS 2.0 Event to Trap
Translator Client Agent for sites that include Windows 2000-based clients that
are configured with SNMP.


STATUS
======

Microsoft has confirmed this to be a problem in Systems Management Server
version 2.0.

Additional query words: prodsms

======================================================================
Keywords          : kbSNMP kbsms200 kbsms200bug 
Technology        : kbSMSSearch kbSMS200
Version           : :2.0
Issue type        : kbbug

=============================================================================

THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.

Copyright Microsoft Corporation 2001.