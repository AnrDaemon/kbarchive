DOCUMENT:Q185816  09-AUG-2001  [winnt]
TITLE   :DNS Server Event Log IDs Incorrect After Applying SP4
PRODUCT :Microsoft Windows NT
PROD/VER:WinNT:4.0
OPER/SYS:
KEYWORDS:

======================================================================
-------------------------------------------------------------------------------
The information in this article applies to:

 - Microsoft Windows NT Server version 4.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

On a Windows NT Server computer running the Domain Name Server (DNS) service,
you will no longer be able to read DNS events created prior to the application
of Service Pack 4 (SP4). All DNS messages will look similar to the following:

   A description for Event (*) in Source (DNS) could not be found. It
   contains the following insertion string(s): *

NOTE: The * would be the Event Identifier and any additional data.

RESOLUTION
==========

To prevent this problem, stop the DNS server service prior to applying SP4 and
save the system event log. The event log offset for DNS events has been changed
as of SP4. To read the saved event logs, perform the following steps:

1. At a command prompt, type:

   Net Stop DNS

2. Change to the %System Root%\System32 Directory and rename the Dns.exe file to
   Dns.exe.sp4.

3. Change to the $NTUninstall directory and copy the old Dns.exe (pre-SP4)
   binary into the %System Root%\system32 directory.

4. Open Event Viewer. You can now view the logs on that computer with the old
   binary.

5. When finished reviewing the log, rename old Dns.exe to Dns.exe.sp3 and rename
   Dns.exe.sp4 to Dns.exe.

6. At a command prompt, type:

   Net Start DNS

An alternative may be to bring up a new DNS server (pre-SP4) and use it to view
old DNS events or saved event logs.

Additional query words: dns Event Log Messages

======================================================================
Keywords          :  
Technology        : kbWinNTsearch kbWinNT400search kbWinNTSsearch kbWinNTS400search kbWinNTS400
Version           : WinNT:4.0
Issue type        : kbbug

=============================================================================

THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.

Copyright Microsoft Corporation 2001.