<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=4c5dc89ca309d19d6d9171a268a55a16d7399494">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Q189588: SMS: SQL Transfer Manager Errors When Moving SMS Database | KnowledgeBase Archive</title>
<meta property="og:title" content="Q189588: SMS: SQL Transfer Manager Errors When Moving SMS Database" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/189/Q189588/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/189/Q189588/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"name":null,"description":"An Archive of Early Microsoft KnowledgeBase Articles","author":null,"@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/189/Q189588/","publisher":null,"image":null,"headline":"Q189588: SMS: SQL Transfer Manager Errors When Moving SMS Database","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q189588-sms-sql-transfer-manager-errors-when-moving-sms-database">Q189588: SMS: SQL Transfer Manager Errors When Moving SMS Database</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q189588
Product(s): Microsoft Systems Management Server
Version(s): winnt:1.2
Operating System(s): 
Keyword(s): kbDatabase smsdatabase
Last Modified: 31-JUL-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Systems Management Server version 1.2 
-------------------------------------------------------------------------------

MORE INFORMATION
================

Sp_site.sql is the script that the Systems Management Server Setup program runs
to create the sp_GetSubSites and sp_GetSubGroupSites stored procedures. Manually
running this script creates the appropriate temporary tables, and also drops and
re-creates the necessary Systems Management Server stored procedures.

SYMPTOMS
========

When using SQL Transfer Manager to move the SMS database from one SQL Server to
another, it is possible to encounter errors similar to the following:

  ::Error::
  In file DATABASE.SMS.PRC in statement on line 1
  Transfer Status: Creating Stored Procedures on destination database
  Invalid object name '#Sites'.

  ::Error::
  In file DATABASE.SMS.PRC in statement on line 1
  Transfer Status: Creating Stored Procedures on destination database
  Invalid object name '#Sites'.

  ::Error::
  In file DATABASE.SMS.PRC in statement on line 105
  Transfer Status: Creating Stored Procedures on destination database
  Invalid object name 'dbo.sp_GetSubGroupSites'.

  ::Error::
  In file DATABASE.SMS.PRC in statement on line 108
  Transfer Status: Creating Stored Procedures on destination database
  Invalid object name '#Sites'.

  ::Error::
  In file DATABASE.SMS.PRC in statement on line 108
  Transfer Status: Creating Stored Procedures on destination database
  Invalid object name '#Sites'.

  ::Error::
  In file DATABASE.SMS.PRC in statement on line 108
  Transfer Status: Creating Stored Procedures on destination database
  Invalid object name '#Sites'.

  ::Error::
  In file DATABASE.SMS.PRC in statement on line 160
  Transfer Status: Creating Stored Procedures on destination database
  Invalid object name 'dbo.sp_GetSubSites'.

CAUSE
=====

These errors indicate a problem with creating the SMS stored procedures. This
can happen if the required temporary tables are not present.

WORKAROUND
==========

To work around this problem and re-create these procedures manually on the
destination server, perform the following steps:

1. Start SQL Enterprise Manager.

2. On the Tools menu, click SQL Query Tool.

3. Select the SMS database.

4. click the Load SQL Script toolbar button.

5. Navigate to the Sms\Site.srv\&lt;Platform&gt;.bin\Sp_site.sql file.

6. Click the Execute Query toolbar button.

Additional query words: prodsms

======================================================================
Keywords          : kbDatabase smsdatabase 
Technology        : kbSMSSearch kbSMS120
Version           : winnt:1.2
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="http://github.com/jeffpar">jeffpar</a><br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>