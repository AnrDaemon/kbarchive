<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=4c5dc89ca309d19d6d9171a268a55a16d7399494">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Q61674: Machine Hangs When BASIC PDS 7.00 Tries to Call QuickC 2.00 | KnowledgeBase Archive</title>
<meta property="og:title" content="Q61674: Machine Hangs When BASIC PDS 7.00 Tries to Call QuickC 2.00" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/061/Q61674/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/061/Q61674/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"name":null,"description":"An Archive of Early Microsoft KnowledgeBase Articles","author":null,"@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/061/Q61674/","publisher":null,"image":null,"headline":"Q61674: Machine Hangs When BASIC PDS 7.00 Tries to Call QuickC 2.00","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q61674-machine-hangs-when-basic-pds-700-tries-to-call-quickc-200">Q61674: Machine Hangs When BASIC PDS 7.00 Tries to Call QuickC 2.00</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q61674
Product(s): See article
Version(s): 7.00
Operating System(s): MS-DOS
Keyword(s): ENDUSER | SR# S900405-131 buglist7.00 S_QuickC | mspl13_basic
Last Modified: 11-MAY-1990

When CALLing Microsoft QuickC version 2.00 from Microsoft BASIC
Professional Development System (PDS) version 7.00, the machine hangs
if a single- or a double-precision number is passed to the C routine
and a comparison of that single- or double-precision number is then
performed in the C routine.

To work around this problem, do one of the following:

1. CALL QuickC from QuickBASIC version 4.50 or from Microsoft BASIC
   Compiler versions 6.00 or 6.00b.

2. Use Microsoft C Compiler version 5.10 instead of QuickC.

3. Pass an integer or a long integer to QuickC instead of the
   floating-point number.

The program below demonstrates the problem.

   Compile and LINK Instructions
   -----------------------------

      BC Basside.bas ;
      QCL /AM /c Cside.c ;
      LINK Basside + Cside,,,BRT70ENR.lib + MLIBCE.LIB ;

   Code Example
   ------------

   ' Here is the BASIC Code

   DECLARE SUB Mycfun CDECL (temp#)

   CLS
   PRINT "On the basic side"
   INPUT "Enter the double precision number "; one#
   CALL Mycfun(one#)
   LOCATE 10, 10
   PRINT "Enter any key to end"
   SLEEP
   CLS
   END

   ' Here is the C code

   #include &lt;c:\qc2\include\stdio.h&gt;

   void Mycfun( double *testdoub)
   {
     printf("I am in the C routine  %lf \n",*testdoub);
    if ((*testdoub) &gt; 2000.0)
     {
        printf ("In the then \n");
     }
     else
     {
        printf("In the else \n");
     };

   printf ("Returning to BASIC \n");

   }
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="http://github.com/jeffpar">jeffpar</a><br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>